name: Build

on:
  push:
    branches:
      - main

jobs:
  test:
    runs-on: ubuntu-latest
    defaults:
      run:
        shell: bash
    steps:
      - uses: actions/checkout@v5
      - uses: actions/setup-go@v6
        with:
          go-version: 'stable'
      - run: go test ./...

  create:
    needs:
      - test
    runs-on: ubuntu-latest
    defaults:
      run:
        shell: bash
    env:
      USER_NAME: "ðŸ¤– GH action"
      USER_MAIL: "--"
    steps:
      - uses: actions/checkout@v5
      - uses: actions/setup-go@v6
        with:
          go-version: 'stable'
      - run: go build -o ./bin/solve
      - run: |
          git config user.email "${USER_MAIL}"
          git config user.name "${USER_NAME}"
      - run: git add ./bin/solve && git commit -m '[auto] update binary'
      - run: git pull --rebase && git push


